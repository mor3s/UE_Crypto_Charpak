#ENIGMA
import itertools
import os, operator


def read(adress = "D:/code/UE_Crypto_Charpak/Codes/message8.txt"):
    with open(adress, 'r', encoding='UTF-8') as file:
        message = file.read() 
    return message

def initialise(gears,key):
    gearspicked = []
    for i in range(3):
        gearspicked.append(rotate(gears[key[0][i]], key[1][i]))
    return gearspicked

  
def rotate(position, angle, radius = 256):
    pos = position[:] # copie
    retenue = angle
    for i in range(len(pos)):
        pos[i] += retenue
        pos[i], retenue = pos[i] % radius, pos[i] // radius
    return pos

def encode_chr(c, gears, position, radius = 256, sens = 1):
    x = ord(c)
    for i in range(len(position)) if sens > 0 else range(len(position)-1, -1, -1):
        x = (gears[i][(x + position[i]) % radius] - position[i]) % radius
    return chr(x)


def encode(txt, gears, position, radius = 256, sens = 1):
    encoded = ""
    for i in range(len(txt)):
        encoded += encode_chr(txt[i], gears, position, radius, sens)
        position = rotate(position, 1,radius)
    return encoded

def invert(gears):
    T = []
    for gear in gears:
        g = gear[:]
        for i in range(len(gear)):
            g[gear[i]] = i
        T.append(g)
    return T


gears = [
            [211, 173, 77, 35, 89, 44, 92, 214, 80, 54, 3, 157, 191, 72, 16, 21, 200, 164, 202, 61, 31, 34, 129, 68, 63, 43, 232, 136, 87, 197, 251, 74, 250, 1, 193, 104, 47, 10, 110, 160, 188, 124, 153, 171, 170, 6, 206, 161, 152, 96, 40, 62, 172, 144, 175, 168, 123, 38, 18, 242, 79, 53, 228, 48, 186, 184, 210, 140, 162, 143, 253, 150, 235, 145, 45, 91, 134, 248, 5, 90, 59, 75, 84, 249, 127, 76, 132, 66, 165, 57, 128, 217, 33, 11, 100, 203, 26, 121, 213, 247, 216, 199, 46, 114, 154, 101, 0, 115, 105, 4, 155, 187, 130, 147, 12, 41, 149, 219, 239, 107, 56, 39, 69, 70, 238, 234, 158, 15, 19, 196, 221, 236, 86, 65, 243, 231, 98, 182, 51, 177, 28, 71, 169, 241, 222, 117, 178, 112, 131, 167, 111, 141, 205, 25, 183, 229, 230, 122, 208, 135, 245, 113, 24, 223, 201, 13, 190, 64, 156, 106, 94, 185, 93, 126, 254, 212, 109, 81, 240, 237, 224, 218, 17, 215, 176, 194, 226, 220, 166, 83, 50, 73, 225, 118, 20, 108, 36, 14, 138, 244, 78, 67, 174, 8, 95, 159, 116, 37, 32, 2, 133, 139, 85, 227, 9, 179, 255, 102, 97, 233, 27, 42, 82, 195, 55, 246, 252, 30, 189, 207, 198, 58, 99, 7, 103, 163, 60, 120, 137, 142, 125, 22, 181, 209, 119, 23, 180, 88, 204, 52, 29, 146, 49, 148, 192, 151],
            [70, 36, 41, 129, 87, 233, 155, 96, 185, 204, 65, 80, 137, 221, 89, 167, 220, 58, 131, 23, 20, 237, 132, 53, 15, 180, 85, 195, 38, 149, 72, 218, 173, 120, 123, 110, 94, 81, 148, 127, 77, 251, 62, 56, 230, 44, 34, 71, 136, 54, 166, 236, 21, 108, 249, 29, 223, 106, 12, 18, 217, 184, 203, 210, 39, 60, 78, 152, 197, 244, 189, 206, 143, 156, 27, 7, 103, 198, 107, 145, 69, 135, 182, 164, 74, 10, 202, 99, 111, 224, 199, 196, 254, 215, 250, 97, 178, 101, 47, 208, 19, 227, 33, 248, 43, 128, 64, 40, 109, 162, 1, 138, 86, 134, 46, 207, 95, 122, 79, 126, 9, 209, 90, 124, 214, 246, 228, 229, 37, 200, 0, 76, 13, 133, 98, 165, 187, 91, 179, 193, 172, 48, 157, 114, 175, 168, 255, 8, 66, 75, 125, 57, 102, 51, 119, 240, 118, 211, 243, 11, 88, 235, 216, 141, 183, 159, 55, 24, 150, 192, 194, 6, 231, 28, 100, 219, 68, 144, 186, 82, 139, 73, 130, 176, 161, 245, 45, 63, 61, 239, 14, 117, 4, 234, 190, 42, 242, 169, 59, 163, 17, 121, 147, 154, 112, 225, 191, 35, 52, 116, 22, 212, 142, 232, 188, 151, 158, 174, 226, 32, 238, 140, 5, 25, 213, 253, 252, 205, 83, 105, 67, 201, 3, 104, 31, 146, 93, 16, 92, 171, 49, 50, 2, 170, 241, 181, 153, 160, 247, 177, 30, 115, 113, 26, 84, 222],
            [7, 106, 109, 229, 172, 34, 253, 174, 130, 14, 99, 107, 157, 79, 30, 147, 39, 19, 35, 24, 47, 205, 124, 67, 136, 246, 27, 237, 149, 142, 55, 245, 105, 21, 74, 101, 91, 10, 120, 137, 233, 8, 72, 73, 1, 119, 122, 20, 100, 251, 203, 85, 81, 153, 150, 83, 127, 50, 48, 144, 197, 70, 133, 210, 234, 227, 179, 68, 219, 71, 76, 173, 22, 167, 90, 190, 58, 64, 60, 244, 5, 28, 95, 63, 159, 195, 140, 236, 56, 115, 193, 65, 213, 89, 239, 145, 108, 23, 97, 6, 61, 25, 31, 228, 254, 231, 206, 164, 217, 32, 148, 232, 126, 141, 16, 11, 77, 188, 112, 154, 138, 255, 57, 135, 146, 88, 3, 121, 224, 223, 160, 152, 215, 46, 62, 132, 249, 111, 176, 170, 184, 93, 202, 103, 104, 87, 177, 86, 118, 171, 41, 165, 155, 230, 44, 175, 15, 163, 13, 98, 180, 94, 226, 114, 194, 207, 26, 162, 178, 9, 182, 183, 216, 143, 123, 196, 158, 169, 218, 186, 38, 116, 51, 204, 29, 198, 250, 185, 80, 12, 211, 191, 78, 125, 161, 208, 54, 200, 247, 17, 168, 252, 37, 166, 0, 181, 242, 187, 139, 241, 151, 53, 201, 36, 243, 214, 238, 43, 192, 220, 18, 225, 113, 134, 45, 129, 96, 40, 156, 248, 84, 75, 209, 235, 52, 42, 92, 240, 110, 4, 189, 66, 49, 221, 117, 199, 102, 59, 82, 128, 212, 33, 2, 222, 131, 69],
            [24, 210, 76, 63, 167, 40, 13, 203, 90, 34, 102, 163, 15, 230, 100, 182, 179, 31, 58, 255, 57, 0, 122, 137, 104, 98, 231, 26, 70, 254, 33, 4, 1, 88, 206, 28, 65, 125, 164, 93, 186, 187, 16, 223, 87, 127, 64, 123, 101, 99, 83, 154, 66, 191, 121, 29, 218, 174, 138, 77, 142, 9, 194, 132, 247, 215, 89, 113, 107, 216, 196, 162, 43, 32, 213, 151, 190, 81, 124, 69, 169, 112, 176, 59, 51, 165, 68, 193, 80, 141, 156, 211, 135, 120, 208, 160, 228, 140, 35, 12, 25, 229, 147, 38, 133, 131, 168, 92, 245, 62, 157, 114, 67, 136, 202, 242, 105, 6, 42, 48, 253, 184, 204, 61, 241, 220, 161, 158, 39, 183, 198, 18, 209, 119, 172, 175, 106, 221, 177, 235, 11, 27, 94, 170, 181, 129, 30, 188, 19, 47, 7, 199, 145, 139, 23, 74, 91, 71, 95, 244, 224, 152, 53, 75, 251, 201, 45, 10, 17, 200, 207, 195, 5, 116, 236, 166, 60, 205, 14, 72, 185, 2, 49, 130, 79, 3, 178, 149, 180, 134, 252, 86, 148, 243, 20, 238, 85, 37, 155, 82, 197, 84, 217, 171, 212, 246, 21, 227, 111, 54, 55, 240, 219, 143, 225, 97, 233, 128, 234, 36, 73, 44, 249, 150, 117, 248, 126, 214, 46, 108, 118, 22, 250, 52, 153, 232, 78, 56, 96, 159, 222, 8, 103, 144, 146, 239, 189, 50, 41, 226, 110, 237, 192, 173, 115, 109],
            [179, 102, 107, 105, 6, 147, 40, 66, 8, 160, 89, 116, 126, 244, 176, 118, 167, 57, 86, 163, 17, 70, 1, 157, 231, 219, 187, 191, 196, 58, 199, 141, 183, 59, 100, 53, 43, 148, 245, 54, 65, 158, 241, 227, 60, 82, 52, 5, 72, 139, 207, 228, 90, 161, 20, 4, 31, 75, 96, 240, 106, 251, 37, 223, 128, 62, 94, 42, 190, 173, 172, 47, 101, 35, 152, 236, 119, 92, 253, 204, 93, 229, 188, 115, 230, 64, 117, 211, 136, 169, 170, 249, 175, 131, 88, 24, 14, 224, 125, 193, 138, 233, 248, 95, 22, 151, 28, 71, 41, 25, 132, 174, 255, 87, 239, 149, 130, 153, 69, 155, 192, 171, 74, 9, 112, 56, 83, 232, 39, 144, 97, 21, 242, 2, 213, 79, 78, 68, 111, 225, 7, 142, 80, 146, 206, 134, 137, 0, 30, 216, 184, 209, 98, 33, 217, 159, 198, 124, 122, 91, 135, 210, 23, 181, 154, 182, 252, 76, 156, 189, 77, 49, 61, 16, 12, 104, 45, 15, 11, 195, 178, 18, 208, 113, 127, 212, 34, 38, 108, 254, 203, 50, 166, 238, 202, 150, 3, 214, 200, 143, 63, 32, 205, 109, 44, 129, 13, 27, 180, 215, 48, 145, 140, 162, 234, 84, 36, 243, 221, 26, 19, 29, 120, 67, 168, 226, 177, 218, 73, 237, 103, 247, 81, 194, 10, 165, 110, 114, 121, 164, 250, 197, 133, 85, 186, 235, 51, 46, 246, 185, 201, 55, 222, 123, 99, 220],
            [7, 188, 27, 179, 50, 254, 167, 117, 35, 149, 89, 81, 186, 39, 133, 28, 83, 112, 249, 165, 31, 194, 86, 237, 64, 203, 45, 241, 6, 226, 156, 171, 172, 43, 200, 41, 24, 90, 131, 122, 127, 232, 168, 180, 139, 78, 108, 0, 22, 94, 107, 162, 14, 59, 175, 84, 98, 132, 251, 46, 116, 70, 99, 29, 74, 135, 182, 44, 15, 192, 229, 138, 201, 198, 79, 92, 77, 69, 208, 75, 253, 148, 109, 134, 174, 96, 34, 5, 93, 151, 185, 189, 164, 8, 72, 227, 114, 20, 106, 142, 231, 103, 204, 129, 244, 19, 217, 25, 80, 71, 145, 23, 17, 178, 221, 169, 88, 214, 215, 219, 32, 143, 230, 42, 195, 177, 255, 121, 85, 36, 157, 183, 225, 222, 216, 181, 144, 191, 193, 212, 243, 202, 250, 38, 110, 58, 209, 240, 111, 205, 224, 223, 37, 82, 245, 115, 21, 102, 128, 210, 239, 68, 147, 234, 54, 52, 206, 238, 176, 100, 53, 137, 118, 40, 184, 155, 4, 220, 199, 247, 150, 57, 30, 48, 10, 26, 236, 197, 158, 130, 2, 63, 55, 166, 16, 124, 228, 60, 95, 65, 153, 213, 190, 163, 126, 97, 62, 161, 141, 123, 104, 207, 76, 3, 125, 218, 146, 91, 140, 9, 196, 119, 47, 235, 12, 1, 11, 105, 18, 173, 13, 154, 51, 152, 67, 160, 248, 33, 73, 211, 66, 242, 56, 61, 170, 233, 187, 252, 120, 136, 87, 49, 113, 246, 159, 101],
            [106, 72, 252, 44, 50, 129, 83, 110, 116, 119, 183, 182, 202, 22, 100, 225, 228, 181, 126, 26, 130, 36, 78, 209, 164, 5, 59, 43, 82, 24, 174, 138, 150, 97, 180, 233, 84, 235, 237, 96, 28, 221, 109, 159, 142, 132, 111, 128, 205, 11, 55, 191, 62, 115, 87, 18, 239, 224, 108, 139, 77, 135, 167, 219, 34, 112, 215, 236, 158, 151, 105, 157, 89, 155, 49, 67, 136, 131, 14, 52, 127, 73, 208, 211, 234, 216, 196, 254, 71, 137, 41, 51, 147, 247, 107, 161, 251, 194, 162, 39, 58, 175, 133, 206, 120, 184, 192, 232, 88, 148, 94, 91, 45, 176, 60, 122, 144, 65, 203, 198, 156, 1, 117, 10, 85, 160, 134, 190, 3, 32, 226, 249, 80, 21, 231, 223, 230, 118, 61, 48, 19, 171, 35, 245, 213, 4, 253, 57, 66, 165, 0, 244, 76, 204, 199, 143, 74, 125, 113, 99, 30, 248, 218, 47, 40, 163, 177, 20, 69, 93, 121, 27, 255, 238, 246, 222, 166, 200, 217, 29, 90, 68, 124, 243, 152, 146, 141, 12, 70, 170, 33, 86, 197, 63, 104, 229, 242, 186, 114, 101, 227, 95, 16, 212, 220, 201, 64, 98, 46, 240, 42, 2, 102, 38, 179, 9, 75, 189, 178, 154, 53, 241, 250, 37, 140, 8, 13, 145, 149, 31, 210, 25, 153, 17, 123, 185, 103, 168, 56, 173, 79, 188, 7, 92, 172, 54, 169, 193, 187, 214, 81, 207, 15, 195, 6, 23],
            [215, 216, 89, 97, 48, 193, 179, 241, 131, 172, 17, 102, 107, 10, 2, 121, 153, 164, 175, 143, 43, 203, 122, 134, 126, 64, 132, 23, 79, 250, 53, 152, 83, 56, 58, 184, 211, 69, 86, 19, 112, 162, 37, 125, 156, 151, 123, 109, 44, 88, 42, 251, 174, 142, 199, 113, 26, 163, 210, 65, 117, 232, 141, 50, 106, 15, 252, 81, 165, 119, 249, 66, 243, 205, 104, 240, 234, 183, 192, 130, 227, 185, 3, 39, 74, 145, 24, 35, 32, 218, 182, 148, 78, 129, 76, 248, 6, 140, 133, 136, 59, 194, 173, 25, 30, 222, 186, 105, 57, 158, 63, 84, 223, 157, 114, 159, 221, 92, 235, 9, 45, 225, 101, 54, 146, 49, 244, 36, 99, 233, 238, 47, 237, 91, 67, 128, 189, 100, 209, 188, 80, 93, 254, 161, 155, 41, 177, 33, 21, 85, 217, 51, 170, 62, 77, 70, 96, 168, 4, 94, 11, 61, 214, 0, 14, 231, 195, 190, 87, 7, 71, 207, 60, 236, 230, 180, 137, 213, 191, 68, 72, 197, 29, 147, 115, 187, 46, 12, 181, 38, 138, 246, 124, 166, 40, 27, 202, 201, 226, 176, 212, 204, 52, 149, 167, 196, 34, 220, 28, 98, 228, 13, 90, 224, 169, 135, 20, 16, 229, 75, 55, 154, 82, 150, 160, 198, 255, 1, 95, 118, 206, 120, 242, 116, 200, 110, 103, 22, 111, 178, 171, 5, 245, 139, 18, 253, 247, 31, 108, 208, 127, 8, 144, 239, 73, 219]
        ]

inv_gears = [[106,33,209,10,109,78,45,233,203,214,37,93,114,165,197,127,14,182,58,128,194,15,241,245,162,153,96,220,140,250,227,20,208,92,21,3,196,207,57,121,50,115,221,25,5,74,102,36,63,252,190,138,249,61,9,224,120,89,231,80,236,19,51,24,167,133,87,201,23,122,123,141,13,191,31,81,85,2,200,60,8,177,222,189,82,212,132,28,247,4,79,75,6,172,170,204,49,218,136,232,94,105,217,234,35,108,169,119,195,176,38,150,147,161,103,107,206,145,193,244,237,97,157,56,41,240,173,84,90,22,112,148,86,210,76,159,27,238,198,211,67,151,239,69,53,73,251,113,253,116,71,255,48,42,104,110,168,11,126,205,39,47,68,235,17,88,188,149,55,142,44,43,52,1,202,54,184,139,146,215,246,242,137,154,65,171,64,111,40,228,166,12,254,34,185,223,129,29,230,101,16,164,18,95,248,152,46,229,158,243,66,0,175,98,7,183,100,91,181,117,187,130,144,163,180,192,186,213,62,155,156,135,26,219,125,72,131,179,124,118,178,143,59,134,199,160,225,99,77,83,32,30,226,70,174,216],[130,110,242,232,192,222,171,75,147,120,85,159,58,132,190,24,237,200,59,100,20,52,210,19,167,223,253,74,173,55,250,234,219,102,46,207,1,128,28,64,107,2,195,104,45,186,114,98,141,240,241,153,208,23,49,166,43,151,17,198,65,188,42,187,106,10,148,230,176,80,0,47,30,181,84,149,131,40,66,118,11,37,179,228,254,26,112,4,160,14,122,137,238,236,36,116,7,95,134,87,174,97,152,76,233,229,57,78,53,108,35,88,204,252,143,251,209,191,156,154,33,201,117,34,123,150,119,39,105,3,182,18,22,133,113,81,48,12,111,180,221,163,212,72,177,79,235,202,38,29,168,215,67,246,203,6,73,142,216,165,247,184,109,199,83,135,50,15,145,197,243,239,140,32,217,144,183,249,96,138,25,245,82,164,61,8,178,136,214,70,194,206,169,139,170,27,91,68,77,90,129,231,86,62,9,227,71,115,99,121,63,157,211,224,124,93,162,60,31,175,16,13,255,56,89,205,218,101,126,127,44,172,213,5,193,161,51,21,220,189,155,244,196,158,69,185,125,248,103,54,94,41,226,225,92,146],[204,44,252,126,239,80,99,0,41,169,37,115,189,158,9,156,114,199,220,17,47,33,72,97,19,101,166,26,81,184,14,102,109,251,5,18,213,202,180,16,227,150,235,217,154,224,133,20,58,242,57,182,234,211,196,30,88,122,76,247,78,100,134,83,77,91,241,23,67,255,61,69,42,43,34,231,70,116,192,13,188,52,248,55,230,51,147,145,125,93,74,36,236,141,161,82,226,98,159,10,48,35,246,143,144,32,1,11,96,2,238,137,118,222,163,89,181,244,148,45,38,127,46,174,22,193,112,56,249,225,8,254,135,62,223,123,24,39,120,208,86,113,29,173,59,95,124,15,110,28,54,210,131,53,119,152,228,12,176,84,130,194,167,157,107,151,203,73,200,177,139,149,4,71,7,155,138,146,168,66,160,205,170,171,140,187,179,207,117,240,75,191,218,90,164,85,175,60,185,245,197,212,142,50,183,21,106,165,195,232,63,190,250,92,215,132,172,108,178,68,219,243,253,129,128,221,162,65,103,3,153,105,111,40,64,233,87,27,216,94,237,209,206,214,79,31,25,198,229,136,186,49,201,6,104,121],[21,32,181,185,31,172,117,150,241,61,167,140,99,6,178,12,42,168,131,148,194,206,231,154,0,100,27,141,35,55,146,17,73,30,9,98,219,197,103,128,5,248,118,72,221,166,228,149,119,182,247,84,233,162,209,210,237,20,18,83,176,123,109,3,46,36,52,112,86,79,28,157,179,220,155,163,2,59,236,184,88,77,199,50,201,196,191,44,33,66,8,156,107,39,142,158,238,215,25,49,14,48,10,242,24,116,136,68,229,255,250,208,81,67,111,254,173,224,230,133,93,54,22,47,78,37,226,45,217,145,183,105,63,104,189,92,113,23,58,153,97,89,60,213,243,152,244,102,192,187,223,75,161,234,51,198,90,110,127,239,95,126,71,11,38,85,175,4,106,80,143,203,134,253,57,135,82,138,186,16,188,144,15,129,121,180,40,41,147,246,76,53,252,87,62,171,70,200,130,151,169,165,114,7,122,177,34,170,94,132,1,91,204,74,227,65,69,202,56,212,125,137,240,43,160,214,249,207,96,101,13,26,235,216,218,139,174,251,195,245,211,124,115,193,159,108,205,64,225,222,232,164,190,120,29,19],[147,22,133,196,55,47,4,140,8,123,234,178,174,206,96,177,173,20,181,220,54,131,104,162,95,109,219,207,106,221,148,56,201,153,186,73,216,62,187,128,6,108,67,36,204,176,247,71,210,171,191,246,46,35,39,251,125,17,29,33,44,172,65,200,85,40,7,223,137,118,21,107,48,228,122,57,167,170,136,135,142,232,45,126,215,243,18,113,94,10,52,159,77,80,66,103,58,130,152,254,34,72,1,230,175,3,60,2,188,203,236,138,124,183,237,83,11,86,15,76,222,238,158,253,157,98,12,184,64,205,116,93,110,242,145,160,88,146,100,49,212,31,141,199,129,211,143,5,37,115,195,105,74,117,164,119,168,23,41,155,9,53,213,19,239,235,192,16,224,89,90,121,70,69,111,92,14,226,180,0,208,163,165,32,150,249,244,26,82,169,68,27,120,99,233,179,28,241,156,30,198,250,194,190,79,202,144,50,182,151,161,87,185,134,197,209,149,154,227,25,255,218,252,63,97,139,225,43,51,81,84,24,127,101,214,245,75,229,193,114,59,42,132,217,13,38,248,231,102,91,240,61,166,78,189,112],[47,225,190,213,176,87,28,0,93,219,184,226,224,230,52,68,194,112,228,105,97,156,48,111,36,107,185,2,15,63,182,20,120,237,86,8,129,152,143,13,173,35,123,33,67,26,59,222,183,251,4,232,165,170,164,192,242,181,145,53,197,243,206,191,24,199,240,234,161,77,61,109,94,238,64,79,212,76,45,74,108,11,153,16,55,128,22,250,116,10,37,217,75,88,49,198,85,205,56,62,169,255,157,101,210,227,98,50,46,82,144,148,17,252,96,155,60,7,172,221,248,127,39,209,195,214,204,40,158,103,189,38,57,14,83,65,249,171,71,44,218,208,99,121,136,110,216,162,81,9,180,89,233,200,231,175,30,130,188,254,235,207,51,203,92,19,193,6,42,115,244,31,32,229,84,54,168,125,113,3,43,135,66,131,174,90,12,246,1,91,202,137,69,138,21,124,220,187,73,178,34,72,141,25,102,149,166,211,78,146,159,239,139,201,117,118,134,106,215,119,177,114,133,151,150,132,29,95,196,70,122,100,41,245,163,223,186,23,167,160,147,27,241,140,104,154,253,179,236,18,142,58,247,80,5,126],[150,121,211,128,145,25,254,242,225,215,123,49,187,226,78,252,202,233,55,140,167,133,13,255,29,231,19,171,40,179,160,229,129,190,64,142,21,223,213,99,164,90,210,27,3,112,208,163,139,74,4,91,79,220,245,50,238,147,100,26,114,138,52,193,206,117,148,75,181,168,188,88,1,81,156,216,152,60,22,240,132,250,28,6,36,124,191,54,108,72,180,111,243,169,110,201,39,33,207,159,14,199,212,236,194,70,0,94,58,42,7,46,65,158,198,53,8,122,137,9,104,170,115,234,182,157,18,80,47,5,20,77,45,102,126,61,76,89,31,59,224,186,44,155,116,227,185,92,109,228,32,69,184,232,219,73,120,71,68,43,125,95,98,165,24,149,176,62,237,246,189,141,244,239,30,101,113,166,218,214,34,17,11,10,105,235,197,248,241,217,127,51,106,247,97,253,86,192,119,154,177,205,12,118,153,48,103,251,82,23,230,83,203,144,249,66,85,178,162,63,204,41,175,135,57,15,130,200,16,195,136,134,107,35,84,37,67,38,173,56,209,221,196,183,151,143,174,93,161,131,222,96,2,146,87,172],[163,227,14,82,158,241,96,169,251,119,13,160,187,211,164,65,217,10,244,39,216,148,237,27,86,103,56,195,208,182,104,247,88,147,206,87,127,42,189,83,194,145,50,20,48,120,186,131,4,125,63,151,202,30,123,220,33,108,34,100,172,161,153,110,25,59,71,134,179,37,155,170,180,254,84,219,94,154,92,28,140,67,222,32,111,149,38,168,49,2,212,133,117,141,159,228,156,3,209,128,137,122,11,236,74,107,64,12,248,47,235,238,40,55,114,184,233,60,229,69,231,15,22,46,192,43,24,250,135,93,79,8,26,98,23,215,99,176,190,243,97,62,53,19,252,85,124,183,91,203,223,45,31,16,221,144,44,113,109,115,224,143,41,57,17,68,193,204,157,214,152,240,9,102,52,18,199,146,239,6,175,188,90,77,35,81,106,185,139,136,167,178,78,5,101,166,205,181,225,54,234,197,196,21,201,73,230,171,249,138,58,36,200,177,162,0,1,150,89,255,207,116,105,112,213,121,198,80,210,218,174,165,61,129,76,118,173,132,130,253,75,7,232,72,126,242,191,246,95,70,29,51,66,245,142,226]]
def enigma(message, key = [[0,1,3], [0,0,0]], radius = 256, sens = 1,gears = gears):
    gearspicked = initialise(gears,key)
    encoded = encode(message, gearspicked, key[1], radius, sens)
    return encoded


# test_chiffre = '#¨à\r\x7f\x87\x1aå\x02¯höÝÃ\x95E&{\n«\x1fAr²i*%¥¿¾¬B\x9aZVä\x9cB}\x0f6\n\x8b_}È¥Å\x98¨sáº\x07¤\n\x04\x8bbúç\x82v¾Û«¢2\x9d\x07²\x17\x80xr\x98«8ëy5¬wÏ\x80-èW½¿D®úH\x89N×\x8bY\x87bþî\n\x0c\n-èX`ÿDac\x03Ø3E©¬>:\x1d\x08±\x1b\x05¦2ûÈ$u\x16ÆÄû)ãmM\x0cVu*ÀÐÃäÆ\x8d@y!;\x00[¼\x85¡F\x14vx\n\x9ehN{xìUpm>Ä®\x84eØ*ä\x91¶\xa0Æ"\x97\x98i³\x0e\x03½P6åN§\x7f\x1fÞ\x15¸16YH\x95þå\x9f¿\x1d.OB\x05\x16\x85-\x88= ¶=ª\x894gÂm\x12û&\x8fo\x16Zã\x83»GaS\x01°\x94òî8À6«\x08\x18\x10â.i\x7f×©\x16·\x1c\x8bÉúç\nðµÛ¬æ±£\x99\x83\x84J\x9eÊ¿\x0c\x94&\'5gx\x8d\x89¢\x1b\x8dÚn\x99hÕ©øäñð·³_\x19¿¥eÀc¥°Ö\x87\xa0\x0bá\x16ökZ¼\x95v\x08\x19\x7f´þ\x83MO\x85\x9fÂìpÛ\x8a\x81\x04\x06\t´\x90âÀ²EÕ\x96ª\x19\x11_\x879Z\x82Ç\xadúo\x06\x9fTÄjïµ\x1c\x0cÜ\x89Å[Ë¦c$\x92ó\x1f8\xad\x02\\dÑRÍ\x9a6M±\x8al±euâ\x14ö\x03û@\xa0\x1dZ\x85.3~\x88Á¡f×CìÙ>°\x0e{|[\x9c]ßµþâö\x01tJôdþ¾.\x9cR;i»_e_mÂ;!¶ÞÅ![@lÇá%\x98E\x82\x10º=©(À<½\x0c"Ö`\x86X²}÷9\x1cL¤ê¨\x8f¡>îøgÈêq*¤\x03Þ\x7fk)MGÑ-\x89Îf\x1f_\x8aý»\x8cCïÆ\x8f\x94¹X¼#ñýær\x15=«@\x93¸Ù/r0a¤á×$\x84\x9ds"¶Ð6n[¯MìíÊÎùñÂn½°¾bî$\x7fûÖ(InáL×H\x18\x1a\x93EÞP\x90\x07?¡\t\xa0\x0c¿¥Ø[W:^\r\x81½ÕÙåöúónÙû} îa\x8a\x16¨\x12Î\x18\xa0.\x89\x9c\x8bñ\x80c¼Ò\x12\x00\rè\x98Êû+\x07¦J\x04\x97ÿ1m\x9bô\x9abçÒ=üèàöXÍb»\x83¯«\x90\x80¾¼Äg»\x03æC.½\x82\x016¡T{\x9f\x1e\x8f¹¦Q!+\x00ùä\t\x19í\x8e\x8d\x8dñ\x11\x8aäû@SR\x81\x01ÑÞ^\x0få£\x12FI¥\'ôÄ÷(I[Ü±à:+\xa0®Ö\'´M\x87!?ÎÒ-[&3H\x9azuÒ´8Cém\x8d6ÂcÎMF3\x01\x81Ó\x1cù9\x9bñ1êÓÔ\x9fõB¡°ÜY´\x82½f·\x15ú74q\x8d\x16baøJWáëT'
# key = [[0,1,2],[0,0,0]]
# test_clair = "Pour trouver la clé, il n'y aura pas tellement d'autre choix a priori que la force brute. Mais la force brute requiert ici un peu de finesse si l'on veut avoir fini avant la fin de l'univers ! En particulier, on peut essayer de tester rapidement si une clé de déchiffrement donne un message en clair qui ressemble à quelque chose (on peut par exemple penser à éliminer rapidement des cas avec des tests simples, et envisager des tests plus élaborées pour ensuite éliminer d'autres cas). Dans tous les cas, la tâche risque de prendre du temps, pensez à largement tester votre algorithme avant de vous lancer et bon déchiffrement ! Pour vous permettre de tester, voici ce que donne le présent paragraphe que je le chiffre avec mon algorithme en utilisant les 3 première roues ci-dessus, en position initiale 0,0,0 :"

# s = enigma(test_clair,key, 256)
# if  s != test_chiffre:
#     print(s[:100])
# else :
#     print("Victoire ! :)")


def brutforce(message):
    for x in itertools.permutations([0,1,2,3,4,5,6,7], 3):
        for y in itertools.product(range(256), repeat=3):
            key = [list(x),list(y)]
            #print(key)
            s = enigma(message,key, 256, 0, inv_gears)
            if  s == "Félicitations":
                print("Victoire ! " + key)

message8 = read("D:/code/UE_Crypto_Charpak/Codes/message8.txt")
#brutforce(message8[:13])

key = [[5, 1, 7], [23, 234, 124]]
print(enigma(message8,key, 256, 0, inv_gears))
